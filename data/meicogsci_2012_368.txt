... title: Optimizing Preprocessing Pipeline for MR Images



Abstract

Introduction: 

After images are processed in a magnetic resonance scanner, further treatment will have to take place, before the actual analysis can occur. For this purpose the preprocessing pipeline converts the data format from the proprietary scanner, which is DICOM (Digital Imaging and Communications in Medicine), to the so called NIfTI format (Neuroimaging Informatics Technology Initiative). DICOM is a standard for medical imaging which contains patients’ data, such as patients ID, name, date of imaging, disorders or experimental issues. DICOMS also include a communication protocol, to support communication between different systems, due to the standardizes format.
The NIfTI format was specially designed for the scientific analysis of brain images. It is simple, compact, but still versatile. The most important feature of storing spatial orientation data within the file is a necessary component for analysis in brain research. Without a proper orientation, brain activity cannot be evaluated. The resulting NIfTI images enclose essential spatial information in order to reduce the chance of errors, which would lead to wrong interpretations. 
Properties and goals of this project are to implement a data processing script in Matlab®, which arranges a sorting data structure for the different image formats. Since this procedure involves a lot of steps and errors can appear at any given state, it is also needful to report any failure that may occur while processing and especially the particular source of it. The script suppose to enable a fail-safe handling and design a user-optimized program for every researcher who may deal with it, without implying any further programming skills.  
In order to provide for conversion from DICOM to NIfTI, images are preprocessed in a pipeline, which was programmed for this purpose to attach the necessary data for spatial orientation.  The images must first be functional and anatomical preprocessed, realigned, which means that slight and unavoidable patient movements during the brain scan will be corrected, so anatomical and functional data merge again. The next procedure is a slice time correction. Images are taken in slices and cannot be processed all at the same time. But since e.g. stimuli occur at a certain time, it is necessary to adjust brain function and time afterwards. To allow comparison over studies, it is required to normalize the brain images to a standard brain. Since every brain morphology is individual, the images will be squeezed and stretched until they cover a standard anatomical brain image. In the end regular image processing take place, such as noise filtering and smoothing.  
For converting the data, the medical MR center worked so far with a data structure, which was mainly implemented in Matlab®, but partly also in Python.  The preprocessing pipeline itself runs in SPM8, a script implemented in Matlab®. Data arrangement and storage though was realized in Python. Since the programming language Matlab® became an important scientifically established and popular computing tool, also for the use of image processing, it is nearby to concentrate the internal data handling of the MR center on this approach and allow an easy, as well as transparent handling for every common user.   

Methods & Results:

In case of any form of interruption during the conversion process of DICOM to NIfTI, the script checks if all DICOMs are converted and applies the processing features according to whatever paradigm the researcher designed for the study, since every preprocessing has to be customized to the respective conditions of the specific study. 
Mostly several measurements for each patient occur in a study. The script also allows applying different paradigms for each measurement, if this is desirable. In the end a report text file informs about all steps that have been taken place and issues that appeared during the preprocessing. Due to these features, the implementation allows a user-friendly and pragmatic handling.

